<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="{{static_url('jquery-3.5.1.min.js')}}" type="text/javascript"></script>

</head>
<body>
    <h1>第{{count}}次访问</h1>
    <form action="/countCookie" method="post" enctype="multipart/form-data">
        {% module xsrf_form_html() %}  <!--配合表单使用-->
        姓名：<input type="text" name="username">
        年龄：<input type="text" name="age">

        <input type="submit" value="提交">
        <button onclick="login()" value="ajax_xsrf">ajax_xsrf</button> <!--配合ajax使用-->

    </form>
    <script>
        function getCookie(name){
            var cook = document.cookie.match("\\b"+name+"=([^;]*)\\b")
            console.log(cook)
            return cook?cook[1]:undefined

        }
        function login(){
            console.log("1")
            data = {
                username: "1",
                password: "2"
            }
            var datastr = JSON.stringify(data)
            $.ajax({
                url:"/countCookie",
                method:"POST",
                data:datastr,
                success:function(data){
                    console.log("ok")
                },
                headers:{
                    "X-XSRFToken":getCookie("_xsrf")
                }
            })
        }
    </script>
</body>
</html>